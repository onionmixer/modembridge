# Telnet Client Multibyte Character Handling Review

## ê°œìš”
í…”ë„· í´ë¼ì´ì–¸íŠ¸ì˜ ë©€í‹°ë°”ì´íŠ¸ ë¬¸ì(UTF-8, EUC-KR ë“±) ì²˜ë¦¬ í˜„í™©ì„ ê²€í† í•˜ê³ , í•œê¸€/ì¼ë³¸ì–´/ì¤‘êµ­ì–´ ë“±ì˜ ë©€í‹°ë°”ì´íŠ¸ ë¬¸ìê°€ ì˜¬ë°”ë¥´ê²Œ ì „ì†¡/ìˆ˜ì‹ ë˜ëŠ”ì§€ ë¶„ì„í•©ë‹ˆë‹¤.

## í˜„ì¬ êµ¬í˜„ ìƒíƒœ

### 1. IAC (0xFF) ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬ âœ… ì–‘í˜¸

#### ìˆ˜ì‹  ê²½ë¡œ: `telnet_process_input()` (src/telnet.c:477-495)
```c
case TELNET_STATE_DATA:
    if (c == TELNET_IAC) {
        tn->state = TELNET_STATE_IAC;
    } else {
        /* Regular data */
        if (out_pos < output_size) {
            output[out_pos++] = c;
        }
    }
```

```c
case TELNET_STATE_IAC:
    if (c == TELNET_IAC) {
        /* Escaped IAC - output single IAC */
        if (out_pos < output_size) {
            output[out_pos++] = TELNET_IAC;
        }
        tn->state = TELNET_STATE_DATA;
    }
```

**ìƒíƒœ**: âœ… **ì˜¬ë°”ë¥´ê²Œ êµ¬í˜„ë¨**
- IAC IAC (0xFF 0xFF) ì‹œí€€ìŠ¤ë¥¼ ë‹¨ì¼ 0xFF ë°”ì´íŠ¸ë¡œ ì •í™•íˆ ë³µì›
- ìƒíƒœ ë¨¸ì‹ ìœ¼ë¡œ ì•ˆì •ì ìœ¼ë¡œ ì²˜ë¦¬

#### ì†¡ì‹  ê²½ë¡œ: `telnet_prepare_output()` (src/telnet.c:267-308)
```c
for (size_t i = 0; i < input_len; i++) {
    unsigned char c = input[i];

    if (c == TELNET_IAC) {
        /* Escape IAC by doubling it */
        if (out_pos + 1 < output_size) {
            output[out_pos++] = TELNET_IAC;
            output[out_pos++] = TELNET_IAC;
        } else {
            /* Output buffer full */
            break;
        }
    } else {
        /* Regular character */
        if (out_pos < output_size) {
            output[out_pos++] = c;
        }
    }
}
```

**ìƒíƒœ**: âœ… **ì˜¬ë°”ë¥´ê²Œ êµ¬í˜„ë¨**
- 0xFFë¥¼ 0xFF 0xFFë¡œ ì •í™•íˆ ì´ìŠ¤ì¼€ì´í”„
- RFC 854 ì¤€ìˆ˜

### 2. Binary Mode í˜‘ìƒ âœ… ì–‘í˜¸

#### ì´ˆê¸° í˜‘ìƒ: `telnet_connect()` (src/telnet.c:105)
```c
/* Send initial option negotiations */
telnet_send_negotiate(tn, TELNET_WILL, TELOPT_BINARY);
```

**ìƒíƒœ**: âœ… **ì˜¬ë°”ë¥´ê²Œ êµ¬í˜„ë¨**
- ì—°ê²° ì‹œ Binary ëª¨ë“œ ì œì•ˆ
- 8ë¹„íŠ¸ ê¹¨ë—í•œ ì „ì†¡ì„ ìœ„í•œ í•„ìˆ˜ í˜‘ìƒ

#### Binary ëª¨ë“œ ì¶”ì 
- `binary_local`: í´ë¼ì´ì–¸íŠ¸ â†’ ì„œë²„ ë°©í–¥ Binary ëª¨ë“œ
- `binary_remote`: ì„œë²„ â†’ í´ë¼ì´ì–¸íŠ¸ ë°©í–¥ Binary ëª¨ë“œ
- ì–‘ë°©í–¥ ë…ë¦½ì ìœ¼ë¡œ ì¶”ì ë¨

**ìƒíƒœ**: âœ… **ì–‘ë°©í–¥ ì¶”ì  ì •ìƒ**

## ì ì¬ì  ë¬¸ì œì 

### âš ï¸ ë¬¸ì œ 1: ë²„í¼ ê²½ê³„ì—ì„œ ë©€í‹°ë°”ì´íŠ¸ ë¬¸ì ë¶„í•  ê°€ëŠ¥ì„±

#### ë¬¸ì œ ìƒí™©
`telnet_process_input()`ì—ì„œ ì¶œë ¥ ë²„í¼ê°€ ê°€ë“ ì°¨ë©´ ë‹¨ìˆœíˆ ì¶”ê°€ ë°”ì´íŠ¸ë¥¼ ë¬´ì‹œí•©ë‹ˆë‹¤:

```c
if (out_pos < output_size) {
    output[out_pos++] = c;
}
// ë²„í¼ ê°€ë“ ì°¬ ê²½ìš°: ë°”ì´íŠ¸ ë¬´ì‹œë¨ (ì†ì‹¤)
```

**ì‹œë‚˜ë¦¬ì˜¤**:
1. ì¶œë ¥ ë²„í¼ì— 2ë°”ì´íŠ¸ ë‚¨ìŒ
2. UTF-8 í•œê¸€ "ì•ˆ" (3ë°”ì´íŠ¸: 0xEC 0x95 0x88)ì´ ë„ì°©
3. 0xEC, 0x95ë§Œ ë³µì‚¬ë˜ê³  0x88ì€ ë¬´ì‹œë¨
4. ë¶ˆì™„ì „í•œ UTF-8 ì‹œí€€ìŠ¤ë¡œ ì¸í•´ ë¬¸ì ê¹¨ì§ ë°œìƒ

#### ì˜í–¥ë„
- **ì‹¬ê°ë„**: ì¤‘ê°„
- **ë°œìƒ í™•ë¥ **: ë‚®ìŒ (ë²„í¼ í¬ê¸°ê°€ ì¶©ë¶„íˆ í° ê²½ìš°ì—ë§Œ ì•ˆì „)
- **ì˜í–¥ ë²”ìœ„**: ë©€í‹°ë°”ì´íŠ¸ ë¬¸ì ì‚¬ìš© ì‹œ (í•œê¸€, ì¼ë³¸ì–´, ì¤‘êµ­ì–´ ë“±)

#### ê¶Œì¥ í•´ê²°ì±…
1. **ë²„í¼ ì¶©ë¶„íˆ í° í¬ê¸° ìœ ì§€**: ìµœì†Œ 4KB ì´ìƒ
2. **ë¶€ë¶„ ì „ì†¡ ì‹œ ì¬ì‹œë„ ë¡œì§**: ë‹¤ìŒ í˜¸ì¶œì—ì„œ ì´ì–´ì„œ ì²˜ë¦¬
3. **ë²„í¼ ì˜¤ë²„í”Œë¡œ ê²½ê³  ë¡œê·¸ ì¶”ê°€**

### âš ï¸ ë¬¸ì œ 2: IAC ì´ìŠ¤ì¼€ì´í”„ ì‹œ ë²„í¼ ê³µê°„ ë¶€ì¡±

#### ë¬¸ì œ ìƒí™©
`telnet_prepare_output()`ì—ì„œ IACë¥¼ ì´ìŠ¤ì¼€ì´í”„í•  ê³µê°„ì´ ë¶€ì¡±í•˜ë©´ ì¤‘ë‹¨:

```c
if (c == TELNET_IAC) {
    if (out_pos + 1 < output_size) {
        output[out_pos++] = TELNET_IAC;
        output[out_pos++] = TELNET_IAC;
    } else {
        /* Output buffer full */
        break;  // ì—¬ê¸°ì„œ ì¤‘ë‹¨ - ë‚¨ì€ ë°ì´í„° ë¬´ì‹œ
    }
}
```

**ì‹œë‚˜ë¦¬ì˜¤**:
1. EUC-KR ë¬¸ìì—´ì— 0xFFê°€ í¬í•¨ë¨ (ì¼ë¶€ í•œê¸€ ë¬¸ì)
2. ì¶œë ¥ ë²„í¼ì— 1ë°”ì´íŠ¸ë§Œ ë‚¨ìŒ
3. 0xFFë¥¼ ì´ìŠ¤ì¼€ì´í”„í•˜ë ¤ë©´ 2ë°”ì´íŠ¸ í•„ìš”
4. ê³µê°„ ë¶€ì¡±ìœ¼ë¡œ break â†’ ì´í›„ ë°ì´í„° ì „ì†¡ ì•ˆ ë¨
5. ë©€í‹°ë°”ì´íŠ¸ ë¬¸ì ì¤‘ê°„ì—ì„œ ëŠê¸°ë©´ ë¬¸ì ê¹¨ì§

**EUC-KRì—ì„œ 0xFF í¬í•¨ ê°€ëŠ¥í•œ ë¬¸ì ì˜ˆ**:
- EUC-KR ë²”ìœ„: 0xA1-0xFE (ì²« ë°”ì´íŠ¸), 0xA1-0xFE (ë‘ ë²ˆì§¸ ë°”ì´íŠ¸)
- ì¼ë¶€ í•œìë‚˜ íŠ¹ìˆ˜ë¬¸ìì—ì„œ 0xFF ê·¼ì²˜ ê°’ ì‚¬ìš© ê°€ëŠ¥

#### ì˜í–¥ë„
- **ì‹¬ê°ë„**: ì¤‘ê°„
- **ë°œìƒ í™•ë¥ **: ë‚®ìŒ (EUC-KR ì‚¬ìš© ì‹œ, íŠ¹ì • ë¬¸ì)
- **ì˜í–¥ ë²”ìœ„**: EUC-KR ì¸ì½”ë”© ì‚¬ìš© í™˜ê²½

#### ê¶Œì¥ í•´ê²°ì±…
1. **ì¶œë ¥ ë²„í¼ í¬ê¸° ì¶©ë¶„íˆ í™•ë³´**: ì…ë ¥ì˜ 2ë°° ì´ìƒ (ëª¨ë“  ë°”ì´íŠ¸ê°€ 0xFFì¼ ê²½ìš° ëŒ€ë¹„)
2. **ë¶€ë¶„ ì „ì†¡ ë°˜í™˜ê°’ ì²˜ë¦¬**: `*output_len`ì„ í†µí•´ ì‹¤ì œ ì²˜ë¦¬ëœ ì…ë ¥ ë°”ì´íŠ¸ ìˆ˜ ë°˜í™˜
3. **í˜¸ì¶œìê°€ ë¯¸ì²˜ë¦¬ ë°ì´í„° ì¬ì‹œë„**

### âš ï¸ ë¬¸ì œ 3: Binary ëª¨ë“œ í˜‘ìƒ ì‹¤íŒ¨ ì‹œ ì²˜ë¦¬ ë¶€ì¬

#### ë¬¸ì œ ìƒí™©
í˜„ì¬ ì½”ë“œëŠ” Binary ëª¨ë“œë¥¼ ì œì•ˆí•˜ì§€ë§Œ, ì„œë²„ê°€ ê±°ë¶€í•  ê²½ìš° íŠ¹ë³„í•œ ì²˜ë¦¬ê°€ ì—†ìŠµë‹ˆë‹¤.

```c
/* ì—°ê²° ì‹œ Binary ëª¨ë“œ ì œì•ˆ */
telnet_send_negotiate(tn, TELNET_WILL, TELOPT_BINARY);

/* í•˜ì§€ë§Œ ì„œë²„ê°€ DONT BINARYë¥¼ ë³´ë‚´ë©´? */
// â†’ binary_local = falseë¡œ ì„¤ì •ë˜ì§€ë§Œ, ê²½ê³ ë‚˜ ëŒ€ì‘ ì—†ìŒ
```

**Non-Binary ëª¨ë“œì˜ ë¬¸ì œì **:
- ì¼ë¶€ ì„œë²„ëŠ” 8ë¹„íŠ¸ ë°ì´í„°ë¥¼ 7ë¹„íŠ¸ë¡œ ë³€í™˜
- ìµœìƒìœ„ ë¹„íŠ¸ê°€ ì œê±°ë˜ê±°ë‚˜ ë³€í˜•ë  ìˆ˜ ìˆìŒ
- ë©€í‹°ë°”ì´íŠ¸ ë¬¸ìê°€ ì†ìƒë¨

#### ì˜í–¥ë„
- **ì‹¬ê°ë„**: ë†’ìŒ
- **ë°œìƒ í™•ë¥ **: ë‚®ìŒ (ëŒ€ë¶€ë¶„ í˜„ëŒ€ ì„œë²„ëŠ” Binary ëª¨ë“œ ì§€ì›)
- **ì˜í–¥ ë²”ìœ„**: Binary ëª¨ë“œ ë¯¸ì§€ì› ì„œë²„ ì—°ê²° ì‹œ ì „ì²´ ë©€í‹°ë°”ì´íŠ¸ ë¬¸ì

#### ê¶Œì¥ í•´ê²°ì±…
1. **Binary ëª¨ë“œ í˜‘ìƒ ê²°ê³¼ í™•ì¸**
2. **ê±°ë¶€ ì‹œ ê²½ê³  ë¡œê·¸ ì¶œë ¥**
3. **ì˜µì…˜: ì‚¬ìš©ìì—ê²Œ ì—°ê²° ê³„ì† ì—¬ë¶€ í™•ì¸**

### âš ï¸ ë¬¸ì œ 4: ìƒìœ„ ê³„ì¸µ(bridge.c) ë²„í¼ ì²˜ë¦¬ í™•ì¸ í•„ìš”

`telnet_prepare_output()`ì™€ `telnet_process_input()`ì´ ë²„í¼ ë¶€ì¡±ìœ¼ë¡œ ì¤‘ë‹¨ë  ë•Œ, ìƒìœ„ ê³„ì¸µì—ì„œ ì¬ì‹œë„ ë¡œì§ì´ í•„ìš”í•©ë‹ˆë‹¤.

**í™•ì¸ í•„ìš” ì‚¬í•­**:
1. bridge.cì—ì„œ ë°˜í™˜ëœ `*output_len`ì„ í™•ì¸í•˜ëŠ”ê°€?
2. ë¯¸ì²˜ë¦¬ëœ ë°ì´í„°ë¥¼ ë‹¤ìŒ ë²ˆì— ì¬ì‹œë„í•˜ëŠ”ê°€?
3. ë²„í¼ í¬ê¸°ê°€ ì¶©ë¶„í•œê°€?

## ë©€í‹°ë°”ì´íŠ¸ ì¸ì½”ë”©ë³„ ìœ„í—˜ë„ ë¶„ì„

### UTF-8 ì¸ì½”ë”© âœ… ëŒ€ì²´ë¡œ ì•ˆì „
- **0xFF í¬í•¨ ê°€ëŠ¥ì„±**: ë§¤ìš° ë‚®ìŒ
  - UTF-8ì—ì„œ 0xFFëŠ” ìœ íš¨í•˜ì§€ ì•Šì€ ë°”ì´íŠ¸ (BOMì—ì„œë§Œ 0xEF 0xBB 0xBF)
  - ì¼ë°˜ ë¬¸ìì—ì„œ 0xFF ê±°ì˜ ë“±ì¥ ì•ˆ í•¨
- **Binary ëª¨ë“œ í•„ìš”ì„±**: ë†’ìŒ (8ë¹„íŠ¸ ê¹¨ë—í•œ ì „ì†¡ í•„ìˆ˜)
- **IAC ì¶©ëŒ**: ê±°ì˜ ì—†ìŒ
- **ê¶Œì¥ ì¡°ì¹˜**: Binary ëª¨ë“œ í˜‘ìƒ í™•ì¸

### EUC-KR ì¸ì½”ë”© âš ï¸ ì£¼ì˜ í•„ìš”
- **0xFF í¬í•¨ ê°€ëŠ¥ì„±**: ì¤‘ê°„
  - EUC-KR ë²”ìœ„: 0xA1-0xFE, ì¼ë¶€ ë¬¸ìì—ì„œ 0xFE ì‚¬ìš©
  - í™•ì¥ ì˜ì—­(UHC)ì—ì„œ 0x81-0xFE ì‚¬ìš© ê°€ëŠ¥
- **Binary ëª¨ë“œ í•„ìš”ì„±**: ë§¤ìš° ë†’ìŒ
- **IAC ì¶©ëŒ**: ë‚®ìŒ (0xFFëŠ” ë²”ìœ„ ë°–)
- **ê¶Œì¥ ì¡°ì¹˜**: Binary ëª¨ë“œ í•„ìˆ˜, IAC ì´ìŠ¤ì¼€ì´í”„ ë²„í¼ ì—¬ìœ  í™•ë³´

### EUC-JP, Shift-JIS âš ï¸ ì£¼ì˜ í•„ìš”
- **0xFF í¬í•¨ ê°€ëŠ¥ì„±**: ì¤‘ê°„
  - Shift-JIS ë°˜ê° ì¹´íƒ€ì¹´ë‚˜ ì˜ì—­: 0x80-0xFF
  - JIS X 0208 í™•ì¥ ì˜ì—­ ì‚¬ìš©
- **Binary ëª¨ë“œ í•„ìš”ì„±**: ë§¤ìš° ë†’ìŒ
- **IAC ì¶©ëŒ**: ë‚®ìŒ
- **ê¶Œì¥ ì¡°ì¹˜**: Binary ëª¨ë“œ í•„ìˆ˜

### GB2312, GBK, Big5 (ì¤‘êµ­ì–´) âš ï¸ ì£¼ì˜ í•„ìš”
- **0xFF í¬í•¨ ê°€ëŠ¥ì„±**: ë‚®ìŒ-ì¤‘ê°„
  - GB2312: 0xA1-0xFE ë²”ìœ„
  - Big5: 0x81-0xFE ë²”ìœ„ (0xFF ì œì™¸)
- **Binary ëª¨ë“œ í•„ìš”ì„±**: ë§¤ìš° ë†’ìŒ
- **IAC ì¶©ëŒ**: ë‚®ìŒ
- **ê¶Œì¥ ì¡°ì¹˜**: Binary ëª¨ë“œ í•„ìˆ˜

## ê¶Œì¥ ê°œì„  ì‚¬í•­ ìš°ì„ ìˆœìœ„

### 1. ë†’ì€ ìš°ì„ ìˆœìœ„ ğŸ”´ âœ… **êµ¬í˜„ ì™„ë£Œ**

#### 1.1 Binary ëª¨ë“œ í˜‘ìƒ ì‹¤íŒ¨ ê²½ê³  ì¶”ê°€ âœ…
**êµ¬í˜„ ìœ„ì¹˜**: `src/telnet.c:278-296` (TELNET_WONT), `src/telnet.c:331-347` (TELNET_DONT)
```c
// telnet_handle_negotiate()ì—ì„œ WONT BINARY ìˆ˜ì‹  ì‹œ
case TELNET_WONT:
    if (option == TELOPT_BINARY) {
        tn->binary_remote = false;
        MB_LOG_WARNING("Server rejected BINARY mode - multibyte characters (UTF-8, EUC-KR) may be corrupted!");
    }

// telnet_handle_negotiate()ì—ì„œ DONT BINARY ìˆ˜ì‹  ì‹œ
case TELNET_DONT:
    if (option == TELOPT_BINARY) {
        tn->binary_local = false;
        MB_LOG_WARNING("Server rejected local BINARY mode - multibyte characters may be corrupted on send!");
    }
```

#### 1.2 ë²„í¼ ì˜¤ë²„í”Œë¡œ ë¡œê·¸ ì¶”ê°€ âœ…
**êµ¬í˜„ ìœ„ì¹˜**: `src/telnet.c:494-510` (process_input), `src/telnet.c:661-691` (prepare_output)
```c
// telnet_process_input()ì—ì„œ
case TELNET_STATE_DATA:
    if (out_pos < output_size) {
        output[out_pos++] = c;
    } else {
        static bool overflow_warned = false;
        if (!overflow_warned) {
            MB_LOG_WARNING("Telnet input buffer full - data may be truncated (multibyte chars may break)");
            overflow_warned = true;
        }
    }

// telnet_prepare_output()ì—ì„œ
if (i < input_len) {
    MB_LOG_WARNING("Telnet output buffer full - %zu of %zu bytes not processed (multibyte chars may break)",
                  input_len - i, input_len);
}
```

### 2. ì¤‘ê°„ ìš°ì„ ìˆœìœ„ ğŸŸ¡

#### 2.1 ë¶€ë¶„ ì²˜ë¦¬ëœ ë°”ì´íŠ¸ ìˆ˜ ë°˜í™˜
`telnet_prepare_output()`ì´ ì‹¤ì œ ì²˜ë¦¬í•œ ì…ë ¥ ë°”ì´íŠ¸ ìˆ˜ë¥¼ ë°˜í™˜í•˜ë„ë¡ ìˆ˜ì •:

```c
// ìƒˆë¡œìš´ íŒŒë¼ë¯¸í„° ì¶”ê°€
int telnet_prepare_output(telnet_t *tn, const unsigned char *input, size_t input_len,
                          unsigned char *output, size_t output_size,
                          size_t *output_len, size_t *input_consumed);
```

#### 2.2 bridge.c ë²„í¼ ì²˜ë¦¬ ê²€í†  ë° ê°œì„ 

### 3. ë‚®ì€ ìš°ì„ ìˆœìœ„ ğŸŸ¢

#### 3.1 UTF-8 ìœ íš¨ì„± ê²€ì‚¬ (ì„ íƒ ì‚¬í•­)
ë©€í‹°ë°”ì´íŠ¸ ë¬¸ì ê²½ê³„ ì¸ì‹ ë° ë²„í¼ ê²½ê³„ì—ì„œ ë¬¸ì ë¶„í•  ë°©ì§€

#### 3.2 ì¸ì½”ë”© ìë™ ê°ì§€ (ì„ íƒ ì‚¬í•­)
ì—°ê²° ì‹œ í„°ë¯¸ë„ ì¸ì½”ë”© í˜‘ìƒ

## ì‹¤ì œ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### í…ŒìŠ¤íŠ¸ 1: UTF-8 í•œê¸€ ì „ì†¡
```
ì…ë ¥: "ì•ˆë…•í•˜ì„¸ìš”" (UTF-8)
ë°”ì´íŠ¸: EC 95 88 EB 85 95 ED 95 98 EC 84 B8 EC 9A 94
ì˜ˆìƒ: Binary ëª¨ë“œì—ì„œ ì •ìƒ ì „ì†¡
```

### í…ŒìŠ¤íŠ¸ 2: EUC-KR í•œê¸€ ì „ì†¡
```
ì…ë ¥: "ì•ˆë…•í•˜ì„¸ìš”" (EUC-KR)
ë°”ì´íŠ¸: BE C8 B3 E7 C7 CF BC BC BF E4
ì˜ˆìƒ: Binary ëª¨ë“œì—ì„œ ì •ìƒ ì „ì†¡
```

### í…ŒìŠ¤íŠ¸ 3: 0xFF í¬í•¨ ë°ì´í„°
```
ì…ë ¥: 0x48 0xFF 0x65 (ê°€ìƒ ë°ì´í„°)
ì†¡ì‹ : 0x48 0xFF 0xFF 0x65 (IAC ì´ìŠ¤ì¼€ì´í”„)
ìˆ˜ì‹ : 0x48 0xFF 0x65 (ë³µì›)
ì˜ˆìƒ: IAC ì´ìŠ¤ì¼€ì´í”„ ì •ìƒ ì‘ë™
```

### í…ŒìŠ¤íŠ¸ 4: ë²„í¼ ê²½ê³„ í…ŒìŠ¤íŠ¸
```
ì¶œë ¥ ë²„í¼: 1022ë°”ì´íŠ¸ ë‚¨ìŒ
ì…ë ¥: 1024ë°”ì´íŠ¸ UTF-8 í…ìŠ¤íŠ¸ (í•œê¸€ í¬í•¨)
ì˜ˆìƒ: ë²„í¼ ì˜¤ë²„í”Œë¡œ ê²½ê³ , ì¼ë¶€ ë°ì´í„° ë¯¸ì²˜ë¦¬
í™•ì¸: ë¯¸ì²˜ë¦¬ ë°ì´í„° ì¬ì „ì†¡ ì—¬ë¶€
```

## ë²„í¼ í¬ê¸° ë¶„ì„ (bridge.c)

### ì‹¤ì œ ë²„í¼ í¬ê¸°
**ìœ„ì¹˜**: `include/common.h:34`
```c
#define BUFFER_SIZE 4096  // 4KB
```

### ì†¡ì‹  ê²½ë¡œ (Serial â†’ Telnet) - `bridge_process_serial_data()`
```c
unsigned char buf[BUFFER_SIZE];              // 4096 bytes - serial read
unsigned char filtered_buf[BUFFER_SIZE];     // 4096 bytes - ANSI filter
unsigned char telnet_buf[BUFFER_SIZE * 2];   // 8192 bytes - IAC escape âœ…
```
**í‰ê°€**: âœ… **ì–‘í˜¸** - IAC ì´ìŠ¤ì¼€ì´í”„ë¥¼ ìœ„í•´ 2ë°° í¬ê¸° í™•ë³´

### ìˆ˜ì‹  ê²½ë¡œ (Telnet â†’ Serial) - `bridge_transfer_telnet_to_serial()`
```c
unsigned char telnet_buf[BUFFER_SIZE];       // 4096 bytes - telnet read
unsigned char processed_buf[BUFFER_SIZE];    // 4096 bytes - IAC removal
unsigned char output_buf[BUFFER_SIZE];       // 4096 bytes - final output
```
**í‰ê°€**: âœ… **ì¶©ë¶„** - IAC ì œê±°ëŠ” í¬ê¸°ë¥¼ ì¤„ì´ë¯€ë¡œ ë™ì¼ í¬ê¸°ë¡œ ì•ˆì „

### ìš©ëŸ‰ ë¶„ì„
- **4096 ë°”ì´íŠ¸ë¡œ ì „ì†¡ ê°€ëŠ¥í•œ ë¬¸ì ìˆ˜**:
  - UTF-8 í•œê¸€ (3ë°”ì´íŠ¸/ë¬¸ì): ì•½ 1,365ì
  - EUC-KR í•œê¸€ (2ë°”ì´íŠ¸/ë¬¸ì): ì•½ 2,048ì
  - ASCII (1ë°”ì´íŠ¸/ë¬¸ì): 4,096ì

**ê²°ë¡ **: ì¼ë°˜ì ì¸ ì‚¬ìš©ì— ì¶©ë¶„í•œ í¬ê¸°

## ê²°ë¡ 

### í˜„ì¬ ìƒíƒœ í‰ê°€: âœ… **ì–‘í˜¸ (2025ë…„ ê°œì„  ì™„ë£Œ)**

#### ì¥ì  âœ…
1. IAC ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬ê°€ RFC 854 í‘œì¤€ ì¤€ìˆ˜
2. Binary ëª¨ë“œ í˜‘ìƒ ì‹œë„ ë° ì‹¤íŒ¨ ì‹œ ê²½ê³  ì¶”ê°€ âœ…
3. ì–‘ë°©í–¥ Binary ëª¨ë“œ ë…ë¦½ ì¶”ì 
4. ìƒíƒœ ë¨¸ì‹  ê¸°ë°˜ì˜ ì•ˆì •ì ì¸ íŒŒì‹±
5. ë²„í¼ ì˜¤ë²„í”Œë¡œ ê²½ê³  ì¶”ê°€ âœ…
6. ì¶©ë¶„í•œ ë²„í¼ í¬ê¸° (4KB â†’ 8KB for escape)

#### ê°œì„  ì™„ë£Œ âœ…
1. âœ… Binary ëª¨ë“œ í˜‘ìƒ ì‹¤íŒ¨ ì‹œ ê²½ê³  ì¶”ê°€ (WONT/DONT BINARY)
2. âœ… ë²„í¼ ì˜¤ë²„í”Œë¡œ ì‹œ ê²½ê³  ë¡œê·¸ (telnet_process_input, telnet_prepare_output)

#### ì¶”ê°€ ê°œì„  ê¶Œì¥ (ì„ íƒ ì‚¬í•­) ğŸŸ¡
1. ë¶€ë¶„ ì „ì†¡ ì‹œ ë¯¸ì²˜ë¦¬ ë°ì´í„° ì¶”ì  ë° ì¬ì‹œë„ ë¡œì§
2. UTF-8 ìœ íš¨ì„± ê²€ì‚¬ ë° ë¬¸ì ê²½ê³„ ì¸ì‹
3. ì¸ì½”ë”© ìë™ ê°ì§€

#### ì‹¤ì‚¬ìš© í‰ê°€
- **UTF-8 í™˜ê²½**: âœ… **ì •ìƒ ì‘ë™** (Binary ëª¨ë“œ í˜‘ìƒ ì„±ê³µ ì‹œ)
  - 0xFFê°€ ê±°ì˜ ë“±ì¥í•˜ì§€ ì•Šì•„ IAC ì¶©ëŒ ìµœì†Œ
  - 4KB ë²„í¼ë¡œ ì•½ 1,365ì ì²˜ë¦¬ ê°€ëŠ¥

- **EUC-KR í™˜ê²½**: âœ… **ì •ìƒ ì‘ë™** (Binary ëª¨ë“œ í•„ìˆ˜)
  - Binary ëª¨ë“œ í˜‘ìƒ ì‹¤íŒ¨ ì‹œ ëª…í™•í•œ ê²½ê³  ì œê³µ
  - 4KB ë²„í¼ë¡œ ì•½ 2,048ì ì²˜ë¦¬ ê°€ëŠ¥

- **ëŒ€ìš©ëŸ‰ ë©€í‹°ë°”ì´íŠ¸ í…ìŠ¤íŠ¸**: âš ï¸ **ì£¼ì˜**
  - 4KB ì´ìƒ ì „ì†¡ ì‹œ ë²„í¼ ì˜¤ë²„í”Œë¡œ ê²½ê³  ì¶œë ¥
  - ì¼ë°˜ í„°ë¯¸ë„ ì‚¬ìš©ì—ëŠ” ì¶©ë¶„í•˜ì§€ë§Œ, íŒŒì¼ ì „ì†¡ ë“±ì—ëŠ” ì œí•œì 

### ìµœì¢… ê¶Œì¥ ì¡°ì¹˜
1. âœ… **ì™„ë£Œ**: Binary ëª¨ë“œ ì‹¤íŒ¨ ê²½ê³  ì¶”ê°€
2. âœ… **ì™„ë£Œ**: ë²„í¼ ì˜¤ë²„í”Œë¡œ ë¡œê·¸ ì¶”ê°€
3. ğŸŸ¡ **ì„ íƒ**: ë¶€ë¶„ ì „ì†¡ ì¬ì‹œë„ ë¡œì§ (í•„ìš” ì‹œ)
4. ğŸŸ¢ **ì„ íƒ**: ì¸ì½”ë”© ìë™ ê°ì§€ ë° ìœ íš¨ì„± ê²€ì‚¬ (ì¥ê¸°)

## ê²€í†  ê²°ê³¼ ìš”ì•½

**ë©€í‹°ë°”ì´íŠ¸ ë¬¸ì ì²˜ë¦¬ ìƒíƒœ**: âœ… **í”„ë¡œë•ì…˜ ì‚¬ìš© ê°€ëŠ¥**

í˜„ì¬ êµ¬í˜„ì€ ë‹¤ìŒì„ ì¶©ì¡±í•©ë‹ˆë‹¤:
- âœ… RFC 854 IAC ì´ìŠ¤ì¼€ì´í”„ ê·œì¹™ ì¤€ìˆ˜
- âœ… Binary ëª¨ë“œ í˜‘ìƒ ë° ì‹¤íŒ¨ ê°ì§€
- âœ… ì¶©ë¶„í•œ ë²„í¼ í¬ê¸° (4KB ~ 8KB)
- âœ… ëª…í™•í•œ ì˜¤ë¥˜ ê²½ê³  ë° ë¡œê¹…
- âœ… UTF-8, EUC-KR, EUC-JP, Big5 ë“± ì£¼ìš” ì¸ì½”ë”© ì§€ì›

í•œê¸€, ì¼ë³¸ì–´, ì¤‘êµ­ì–´ ë“± ë©€í‹°ë°”ì´íŠ¸ ë¬¸ìë¥¼ ì‚¬ìš©í•˜ëŠ” ì¼ë°˜ì ì¸ í…”ë„· ì„¸ì…˜ì—ì„œ ì•ˆì •ì ìœ¼ë¡œ ì‘ë™í•  ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤.
