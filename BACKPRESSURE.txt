백프레셔(backpressure)는 생산자와 소비자의 처리 속도가 불일치할 때 과부하를 방지하기 위해 생산 측의 전송을 늦추거나 멈추게 만드는 흐름 제어 메커니즘이며, 수위선은 버퍼의 사용량에 대해 동작을 전환하는 임계값(예: high/low watermark)을 뜻합니다. 실무적으로는 high watermark를 넘으면 입력을 멈추고, low watermark 아래로 내려오면 입력을 재개하는 방식으로 백프레셔를 구현합니다.

==개념 요약==

* 백프레셔: 소비자보다 생산자가 빠를 때 버퍼가 넘치지 않도록 생산 속도를 조절·차단하는 일반적 흐름 제어입니다.
* 수위선: 버퍼 임계값으로, high watermark를 초과하면 쓰기 중단 신호를 내고, low watermark 미만이면 재개 신호를 내는 운영 규칙입니다.


==왜 필요한가==

* 무제한 버퍼링은 메모리 급증과 지연 확대를 초래하며, 드롭·지연·폭주 등 부작용을 낳기 때문에 임계 기반 제어가 필수입니다.
* 네트워크·스트림 시스템은 읽기/쓰기 속도 차이가 상시 발생하므로 백프레셔가 안정성과 손실 방지의 핵심입니다.


==실무 적용==

* 스트림/소켓에서 highWatermark를 초과하면 쓰기 API가 false를 반환해 “잠시 멈춤” 신호를 주고, drain 이벤트 등으로 lowWatermark 하회 시 재개합니다.
* 전송 계층도 슬라이딩 윈도우로 수신 가능 용량만큼만 보내도록 배압을 구현하며, 실시간 전송(WebRTC 등)도 채널 용량을 측정해 넘지 않도록 송신을 조절합니다.


==구현 팁==

* 버퍼 임계 설계: 예를 들어 main 버퍼 64KB에서 high=48KB, low=24KB로 두고 high 이상이면 입력 일시중지, low 미만이면 재개하도록 합니다.
* 제어 수단: 쓰기 반환값/이벤트 기반 일시정지·재개, 스로틀/레이트리미트, 필요 시 드롭·샘플링(프레임 건너뛰기) 등으로 조합합니다.


==용어 정리==

* High watermark: “이 이상이면 더 받지 마라”는 상한 임계점으로, 넘는 순간 백프레셔를 활성화합니다.
* Low watermark: “이 이하로 내려오면 재개”하는 하한 임계점으로, 재가동의 히스테리시스 경계를 만듭니다.

